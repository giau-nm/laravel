<div class="mobile-menu">

    <?php if(!Auth::guest()): ?>

      <?php $user = Auth::user(); ?>
      <?php $user_points = DB::table('points')->where('user_id', '=', $user->id)->sum('points'); ?>
      <a href="<?php echo URL::to('user') . '/' . $user->username;; ?>" class="usr-avatar"><img src="<?php echo Config::get('site.uploads_dir'); ?>avatars/<?php echo $user->avatar; ?>" alt="<?php echo $user->username; ?>" class="img-circle user-avatar-large"></a>
      <a href="<?php echo URL::to('user') . '/' . $user->username;; ?>" class="username"><h2><?php if(strlen(Auth::user()->username) > 14): ?><?php echo substr(Auth::user()->username, 0, 14) . '...'; ?><?php else: ?><?php echo Auth::user()->username; ?><?php endif; ?></h2></a>
      <p class="points"><i class="fa fa-star" style="color:gold"></i> <?php echo $user_points; ?> points</p>
      <div id="avatar-bg"></div>

    <?php endif; ?>

    <ul>
      <li class="<?php if(Request::is('/') || Request::is('category/*')): ?> active <?php endif; ?>"><a href="<?php echo URL::to('/'); ?>"><i class="fa fa-home"></i> <?php echo Lang::get('lang.home'); ?></a></li>
     <li class="dropdown <?php if(Request::is('popular/*') || Request::is('popular')): ?> active <?php endif; ?>">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-star"></i> <?php echo Lang::get('lang.popular'); ?> <b class="caret"></b></a>
      <ul class="dropdown-menu">
        <li><a href="<?php echo URL::to('popular/week'); ?>"><?php echo Lang::get('lang.for_the_week'); ?></a></li>
        <li><a href="<?php echo URL::to('popular/month'); ?>"><?php echo Lang::get('lang.for_the_month'); ?></a></li>
        <li><a href="<?php echo URL::to('popular/year'); ?>"><?php echo Lang::get('lang.for_the_year'); ?></a></li>
        <li><a href="<?php echo URL::to('popular'); ?>"><?php echo Lang::get('lang.all_time'); ?></a></li>
      </ul>
    </li>
    
    <?php $categories = Category::orderBy('order', 'ASC')->get(); ?>

    <li class="dropdown">
        <a href="#" class="dropdown-toggle categories" data-toggle="dropdown"><i class="fa fa-folder-open"></i> <?php echo Lang::get('lang.categories'); ?> <b class="caret"></b></a>
        
        <ul class="dropdown-menu">
            <li>
                <?php foreach ($categories as $category): ?>
                  <a href="<?php echo URL::to('category') . '/' . strtolower($category->name); ?>"><?php echo $category->name; ?></a>
                <?php endforeach; ?>
            </li>
          </ul>
   </li>

   <?php if($settings->pages_in_menu): ?>
   <li class="dropdown <?php if(Request::is('pages/*') || Request::is('pages')): ?> active <?php endif; ?>">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-file-text"></i> <?php echo $settings->pages_in_menu_text; ?> <b class="caret"></b></a>
      <ul class="dropdown-menu">
        <?php $pages = Page::all(); ?>
        <?php foreach($pages as $page): ?>
          <li><a href="<?php echo URL::to('pages') . '/' . $page->url; ?>"><?php echo $page->title; ?></a></li>
        <?php endforeach; ?>
      
      </ul>
    </li>
    <?php endif; ?>

   <li><a href="<?php echo URL::to('/random'); ?>"><i class="fa fa-random"></i> <?php echo Lang::get('lang.random'); ?></a></li>

</ul>  